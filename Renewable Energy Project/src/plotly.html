<head>
  <!-- Plotly.js -->
  <script src='https://cdn.plot.ly/plotly-2.16.1.min.js'></script>
	<script src='https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.17/d3.min.js'></script>
</head>

</head>

<p>
    Here's a simple Plotly plot -
    <a href="https://bit.ly/1Or9igj">plotly.js documentation</a>
</p>

<!-- Plots go in blank <div> elements.
    You can size them in the plot layout,
    or give the div a size as shown here.
-->
<div id="tester" style="width:90%;height:250px;"></div>

  <script>

    let countries_names = ["Afghanistan","Albania", "Argentina", "Armenia", "Antarctica", "Australia", "Burundi", "Belgium", "Bangladesh", "Belarus", "Belize" ];
    let latest_energy = [10, 20, 100, 5, 7, 12, 15, 100, 150, 50, 100];
    let countriesID = [];

    d3.csv('dataset.csv', function(err, rows){
        function unpack(rows, key) {
            return rows.map(function(row) { return row[key]; });
        }

  let countries = unpack(rows, 'Entity');
  let latest_energy = unpack(rows, 'Entity');
  console.log(countries);


      for(let i = 0; i < countries_names.length; i++){
         if (countries.includes(countries_names[i])){
           console.log(countries_names[i]);
            countriesID[i] = countries[countries.indexOf(countries_names[i])];
            //latest_energy[i] = [countries_names[i]][2020];
          }
       }
        // for (let i = 0; i < locations.length, i++){
        //   if ()
        // }


          let graph_data = [{
              type: 'choropleth',
              locationmode: 'country names',
              locations: countriesID,
              z: latest_energy,
              text: countries_names,
              autocolorscale: true
          }];

          let layout = {
            title: 'Pure alcohol consumption<br>among adults (age 15+) in 2010',
            geo: {
                projection: {
                    type: 'robinson'
                }
            }
          };

          Plotly.newPlot("tester", graph_data, layout, {showLink: false});

      });


  //  let countriesID = [];



    //var countries = [];
// countries_names = countries_names.map(country_name, funtion(){
//   return geoJson.features[country_name].properties.id
// });



  </script>
